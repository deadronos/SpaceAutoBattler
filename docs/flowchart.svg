<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: SpaceAutoBattler Pages: 1 -->
<svg width="1038pt" height="328pt"
 viewBox="0.00 0.00 1038.06 328.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 324)">
<title>SpaceAutoBattler</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-324 1034.056,-324 1034.056,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_sim</title>
<path fill="none" stroke="#000000" d="M819.822,-227C819.822,-227 1010.056,-227 1010.056,-227 1016.056,-227 1022.056,-233 1022.056,-239 1022.056,-239 1022.056,-300 1022.056,-300 1022.056,-306 1016.056,-312 1010.056,-312 1010.056,-312 819.822,-312 819.822,-312 813.822,-312 807.822,-306 807.822,-300 807.822,-300 807.822,-239 807.822,-239 807.822,-233 813.822,-227 819.822,-227"/>
<text text-anchor="middle" x="914.939" y="-295.4" font-family="Times,serif" font-size="14.00" fill="#000000">Simulation</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_renderer</title>
<path fill="none" stroke="#000000" d="M841.7565,-22C841.7565,-22 988.1215,-22 988.1215,-22 994.1215,-22 1000.1215,-28 1000.1215,-34 1000.1215,-34 1000.1215,-141 1000.1215,-141 1000.1215,-147 994.1215,-153 988.1215,-153 988.1215,-153 841.7565,-153 841.7565,-153 835.7565,-153 829.7565,-147 829.7565,-141 829.7565,-141 829.7565,-34 829.7565,-34 829.7565,-28 835.7565,-22 841.7565,-22"/>
<text text-anchor="middle" x="914.939" y="-136.4" font-family="Times,serif" font-size="14.00" fill="#000000">Renderer</text>
</g>
<!-- bootstrap -->
<g id="node1" class="node">
<title>bootstrap</title>
<polygon fill="none" stroke="#000000" points="117.45,-160 15.252,-160 15.252,-80 117.45,-80 117.45,-160"/>
<text text-anchor="middle" x="66.351" y="-147" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">Bootstrap</text>
<text text-anchor="middle" x="66.351" y="-135" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">(index / main)</text>
<text text-anchor="middle" x="66.351" y="-123" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; find canvas</text>
<text text-anchor="middle" x="66.351" y="-111" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; create renderer</text>
<text text-anchor="middle" x="66.351" y="-99" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; seed RNG?</text>
<text text-anchor="middle" x="66.351" y="-87" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; reset() / initStars()</text>
</g>
<!-- loop -->
<g id="node2" class="node">
<title>loop</title>
<ellipse fill="none" stroke="#000000" cx="278.0534" cy="-112" rx="108.203" ry="31.2258"/>
<text text-anchor="middle" x="278.0534" y="-121" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">Game Loop</text>
<text text-anchor="middle" x="278.0534" y="-109" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">requestAnimationFrame / timer</text>
<text text-anchor="middle" x="278.0534" y="-97" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45;&gt; simulate(dt) &#45;&gt; render(state)</text>
</g>
<!-- bootstrap&#45;&gt;loop -->
<g id="edge4" class="edge">
<title>bootstrap&#45;&gt;loop</title>
<path fill="none" stroke="#000000" d="M117.5982,-118.0634C130.6231,-117.5712 145.1669,-117.0216 160.0352,-116.4598"/>
<polygon fill="#000000" stroke="#000000" points="160.5052,-119.9446 170.3658,-116.0694 160.2408,-112.9496 160.5052,-119.9446"/>
</g>
<!-- assets -->
<g id="node9" class="node">
<title>assets</title>
<polygon fill="none" stroke="#000000" points="132.5533,-44 129.5533,-48 108.5533,-48 105.5533,-44 .1487,-44 .1487,0 132.5533,0 132.5533,-44"/>
<text text-anchor="middle" x="66.351" y="-31" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">Assets / Starfield</text>
<text text-anchor="middle" x="66.351" y="-19" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">createStarCanvas(state)</text>
<text text-anchor="middle" x="66.351" y="-7" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; cached offscreen canvas</text>
</g>
<!-- bootstrap&#45;&gt;assets -->
<g id="edge9" class="edge">
<title>bootstrap&#45;&gt;assets</title>
<path fill="none" stroke="#000000" d="M66.351,-79.7329C66.351,-71.3131 66.351,-62.8933 66.351,-54.4735"/>
<polygon fill="#000000" stroke="#000000" points="69.8511,-54.2031 66.351,-44.2031 62.8511,-54.2032 69.8511,-54.2031"/>
</g>
<!-- sim -->
<g id="node3" class="node">
<title>sim</title>
<polygon fill="none" stroke="#000000" points="657.9571,-217 423.2205,-217 423.2205,-161 657.9571,-161 657.9571,-217"/>
<text text-anchor="middle" x="540.5888" y="-204" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">simulate(dt, W,H)</text>
<text text-anchor="middle" x="540.5888" y="-192" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; build state object</text>
<text text-anchor="middle" x="540.5888" y="-180" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; call simulateStep(state, dt, bounds)</text>
<text text-anchor="middle" x="540.5888" y="-168" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; collect events: explosions, shieldHits, healthHits</text>
</g>
<!-- loop&#45;&gt;sim -->
<g id="edge5" class="edge">
<title>loop&#45;&gt;sim</title>
<path fill="none" stroke="#000000" d="M353.9895,-134.2716C379.2112,-141.6689 407.7686,-150.0447 434.823,-157.9795"/>
<polygon fill="#000000" stroke="#000000" points="434.1325,-161.4244 444.7134,-160.8803 436.1027,-154.7074 434.1325,-161.4244"/>
</g>
<!-- renderer -->
<g id="node5" class="node">
<title>renderer</title>
<polygon fill="none" stroke="#000000" points="627.3279,-135 453.8496,-135 453.8496,-79 627.3279,-79 627.3279,-135"/>
<text text-anchor="middle" x="540.5888" y="-122" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">renderer.js / webglRenderer.js</text>
<text text-anchor="middle" x="540.5888" y="-110" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; consume state &amp; event arrays</text>
<text text-anchor="middle" x="540.5888" y="-98" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; draw ships, bullets, particles</text>
<text text-anchor="middle" x="540.5888" y="-86" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; visual&#45;only effects (no game logic)</text>
</g>
<!-- loop&#45;&gt;renderer -->
<g id="edge8" class="edge">
<title>loop&#45;&gt;renderer</title>
<path fill="none" stroke="#000000" stroke-dasharray="1,5" d="M386.3523,-109.9374C405.3014,-109.5766 424.9097,-109.2031 443.5306,-108.8485"/>
<polygon fill="#000000" stroke="#000000" points="443.832,-112.3435 453.7635,-108.6536 443.6987,-105.3447 443.832,-112.3435"/>
</g>
<!-- rng -->
<g id="node4" class="node">
<title>rng</title>
<polygon fill="none" stroke="#000000" points="1008.1731,-279 815.7048,-279 815.7048,-235 1014.1731,-235 1014.1731,-273 1008.1731,-279"/>
<polyline fill="none" stroke="#000000" points="1008.1731,-279 1008.1731,-273 "/>
<polyline fill="none" stroke="#000000" points="1014.1731,-273 1008.1731,-273 "/>
<text text-anchor="middle" x="914.939" y="-266" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">RNG (src/rng.js)</text>
<text text-anchor="middle" x="914.939" y="-254" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">srand(seed)</text>
<text text-anchor="middle" x="914.939" y="-242" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; deterministic randomness for simulation</text>
</g>
<!-- sim&#45;&gt;rng -->
<g id="edge1" class="edge">
<title>sim&#45;&gt;rng</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M658.0084,-210.3291C705.153,-218.8928 759.1874,-228.708 805.5003,-237.1207"/>
<polygon fill="#000000" stroke="#000000" points="805.0999,-240.6051 815.5645,-238.9488 806.351,-233.7178 805.0999,-240.6051"/>
</g>
<!-- events -->
<g id="node8" class="node">
<title>events</title>
<polygon fill="none" stroke="#000000" points="962.5721,-217 861.3059,-217 861.3059,-161 968.5721,-161 968.5721,-211 962.5721,-217"/>
<polyline fill="none" stroke="#000000" points="962.5721,-217 962.5721,-211 "/>
<polyline fill="none" stroke="#000000" points="968.5721,-211 962.5721,-211 "/>
<text text-anchor="middle" x="914.939" y="-204" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">Event arrays in state</text>
<text text-anchor="middle" x="914.939" y="-192" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; state.explosions[]</text>
<text text-anchor="middle" x="914.939" y="-180" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; state.shieldHits[]</text>
<text text-anchor="middle" x="914.939" y="-168" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; state.healthHits[]</text>
</g>
<!-- sim&#45;&gt;events -->
<g id="edge6" class="edge">
<title>sim&#45;&gt;events</title>
<path fill="none" stroke="#000000" d="M658.0084,-189C721.7323,-189 798.0438,-189 850.8605,-189"/>
<polygon fill="#000000" stroke="#000000" points="851.0999,-192.5001 861.0998,-189 851.0998,-185.5001 851.0999,-192.5001"/>
</g>
<!-- gl -->
<g id="node6" class="node">
<title>gl</title>
<polygon fill="none" stroke="#000000" points="992.3044,-66 837.5735,-66 837.5735,-62 833.5735,-62 833.5735,-58 837.5735,-58 837.5735,-38 833.5735,-38 833.5735,-34 837.5735,-34 837.5735,-30 992.3044,-30 992.3044,-66"/>
<polyline fill="none" stroke="#000000" points="837.5735,-62 841.5735,-62 841.5735,-58 837.5735,-58 "/>
<polyline fill="none" stroke="#000000" points="837.5735,-38 841.5735,-38 841.5735,-34 837.5735,-34 "/>
<text text-anchor="middle" x="914.939" y="-51" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">WebGL path (instanced)</text>
<text text-anchor="middle" x="914.939" y="-39" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; VBOs, instancing, diagnostics</text>
</g>
<!-- renderer&#45;&gt;gl -->
<g id="edge2" class="edge">
<title>renderer&#45;&gt;gl</title>
<path fill="none" stroke="#000000" d="M627.4293,-91.339C643.4899,-88.5484 660.1285,-85.7279 675.7728,-83.2 725.9433,-75.0932 782.1628,-66.7799 827.4834,-60.2694"/>
<polygon fill="#000000" stroke="#000000" points="828.1694,-63.7069 837.5719,-58.824 827.1766,-56.7777 828.1694,-63.7069"/>
<text text-anchor="middle" x="736.7974" y="-88.2" font-family="Times,serif" font-size="14.00" fill="#000000">prefer</text>
</g>
<!-- canvas -->
<g id="node7" class="node">
<title>canvas</title>
<polygon fill="none" stroke="#000000" points="964.7866,-120 865.0914,-120 865.0914,-116 861.0914,-116 861.0914,-112 865.0914,-112 865.0914,-92 861.0914,-92 861.0914,-88 865.0914,-88 865.0914,-84 964.7866,-84 964.7866,-120"/>
<polyline fill="none" stroke="#000000" points="865.0914,-116 869.0914,-116 869.0914,-112 865.0914,-112 "/>
<polyline fill="none" stroke="#000000" points="865.0914,-92 869.0914,-92 869.0914,-88 865.0914,-88 "/>
<text text-anchor="middle" x="914.939" y="-99" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">Canvas2D fallback</text>
</g>
<!-- renderer&#45;&gt;canvas -->
<g id="edge3" class="edge">
<title>renderer&#45;&gt;canvas</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M627.4132,-105.8403C697.1399,-104.909 793.245,-103.6254 854.7446,-102.804"/>
<polygon fill="#000000" stroke="#000000" points="855.1065,-106.2996 865.0589,-102.6662 855.013,-99.3002 855.1065,-106.2996"/>
<text text-anchor="middle" x="736.7974" y="-110.2" font-family="Times,serif" font-size="14.00" fill="#000000">fallback</text>
</g>
<!-- renderer&#45;&gt;assets -->
<g id="edge10" class="edge">
<title>renderer&#45;&gt;assets</title>
<path fill="none" stroke="#000000" stroke-dasharray="1,5" d="M467.795,-78.8692C442.382,-70.0368 413.4486,-61.07 386.4048,-55.2 304.2707,-37.3724 208.1332,-29.0324 142.8204,-25.1857"/>
<polygon fill="#000000" stroke="#000000" points="142.7919,-21.6786 132.6096,-24.6062 142.3951,-28.6673 142.7919,-21.6786"/>
<text text-anchor="middle" x="278.0534" y="-60.2" font-family="Times,serif" font-size="14.00" fill="#000000">draw starCanvas</text>
</g>
<!-- events&#45;&gt;renderer -->
<g id="edge7" class="edge">
<title>events&#45;&gt;renderer</title>
<path fill="none" stroke="#000000" d="M861.2788,-177.2459C802.9737,-164.4744 708.6176,-143.8061 637.3151,-128.1875"/>
<polygon fill="#000000" stroke="#000000" points="637.9305,-124.7394 627.4132,-126.0186 636.4326,-131.5773 637.9305,-124.7394"/>
<text text-anchor="middle" x="736.7974" y="-166.2" font-family="Times,serif" font-size="14.00" fill="#000000">consumed each frame</text>
</g>
<!-- diag -->
<g id="node10" class="node">
<title>diag</title>
<polygon fill="none" stroke="#000000" points="367.6508,-217 182.456,-217 182.456,-161 373.6508,-161 373.6508,-211 367.6508,-217"/>
<polyline fill="none" stroke="#000000" points="367.6508,-217 367.6508,-211 "/>
<polyline fill="none" stroke="#000000" points="373.6508,-211 367.6508,-211 "/>
<text text-anchor="middle" x="278.0534" y="-204" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">Diagnostics &amp; Tests</text>
<text text-anchor="middle" x="278.0534" y="-192" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; Vitest unit tests</text>
<text text-anchor="middle" x="278.0534" y="-180" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; Playwright E2E (opt&#45;in)</text>
<text text-anchor="middle" x="278.0534" y="-168" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">&#45; renderer diagnostics exposed for tests</text>
</g>
<!-- diag&#45;&gt;sim -->
<g id="edge12" class="edge">
<title>diag&#45;&gt;sim</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.9491,-189C386.6721,-189 399.8742,-189 413.0266,-189"/>
<polygon fill="#000000" stroke="#000000" points="413.066,-192.5001 423.0659,-189 413.0659,-185.5001 413.066,-192.5001"/>
</g>
<!-- diag&#45;&gt;renderer -->
<g id="edge11" class="edge">
<title>diag&#45;&gt;renderer</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M368.0359,-160.895C392.5404,-153.2413 419.1819,-144.9201 444.0348,-137.1575"/>
<polygon fill="#000000" stroke="#000000" points="445.3265,-140.4209 453.8283,-134.0987 443.2395,-133.7393 445.3265,-140.4209"/>
</g>
</g>
</svg>
